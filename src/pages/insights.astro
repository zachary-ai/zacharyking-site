---
import { getCollection } from 'astro:content';
import Layout from '../components/layout/Layout.astro';
import Section from '../components/ui/Section.astro';

const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort((a, b) => {
  return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
});
---

<Layout
  title="Insights - AI-Powered GTM Systems & Sales Strategy"
  description="GTM frameworks, AI sales automation insights, and lessons from building revenue systems for B2B SaaS startups."
>
  <Section background="dark">
    <div class="max-w-5xl mx-auto">
      <div class="text-center mb-16">
        <h1 class="mb-8">Insights</h1>
        <p class="text-2xl max-w-3xl mx-auto" style="color: var(--color-text-secondary);">
          Practical GTM insights, frameworks, and lessons from building AI-powered revenue systems for B2B SaaS startups.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {sortedPosts.map((post) => (
          <a
            href={`/insights/${post.data.slug || post.id}`}
            class="card group block"
            onclick={`gtag('event', 'insights_article_click', { 'article_title': '${post.data.title.replace(/'/g, "\\'")}', 'article_slug': '${post.data.slug || post.id}' }); return true;`}
          >
            <div class="mb-4">
              <time class="text-sm" style="color: var(--color-accent-blue); font-family: 'DM Sans', sans-serif; letter-spacing: 0.05em; font-weight: 600;">
                {new Date(post.data.date).toLocaleDateString('en-AU', { year: 'numeric', month: 'long', day: 'numeric' })}
              </time>
            </div>
            <h2 class="text-2xl md:text-3xl font-bold mb-4 transition-colors duration-300 group-hover:text-[var(--color-accent-blue)]" style="font-family: 'DM Sans', sans-serif; color: var(--color-text-primary);">
              {post.data.title}
            </h2>
            <p class="text-lg leading-relaxed mb-6" style="color: var(--color-text-secondary);">
              {post.data.excerpt}
            </p>
            <div class="flex items-center gap-2 text-[var(--color-accent-blue)] font-semibold group-hover:gap-3 transition-all duration-300">
              Read more
              <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </div>
          </a>
        ))}
      </div>
    </div>
  </Section>

  <!-- Newsletter CTA -->
  <Section background="elevated">
    <div class="max-w-3xl mx-auto text-center">
      <h2 class="mb-6">Want more insights?</h2>
      <p class="text-xl mb-8" style="color: var(--color-text-secondary);">
        Join the Fractional Newsletter for practical GTM insights delivered weekly.
      </p>
      <a
        href="https://thefractionalexec.com.au/newsletter"
        target="_blank"
        rel="noopener noreferrer"
        class="btn-primary inline-flex items-center gap-2"
        onclick="gtag('event', 'newsletter_signup_click', { 'location': 'insights_page' }); return true;"
      >
        Subscribe to Newsletter
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
        </svg>
      </a>
    </div>
  </Section>
</Layout>
